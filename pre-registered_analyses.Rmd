---
title: "Pre-registered Analyses"
author: "Adam Parker"
date: "28/05/2020"
output:
  pdf_document: default
  html_document: default
---

The Markdown script addresses the research questions outlined in the pre-registration for "Assessing reliability of an online behavioural laterality battery"  (https://osf.io/fktmh).

Below are the research questions that we sought to address. 

Research Question

- Is it possible to achieve test-retest reliability of .65 or more with laterality indices derived from the four laterality tests? If so, could this be achieved more efficiently by using fewer trials in each test?

- Laterality indices can be calculated in multiple different ways (e.g. using RT, accuracy or a combination of the two; as a raw difference score or a proportion). We will explore these options to determine which metric shows the strongest test-retest reliability.

- Do extreme left-handers show a higher rate of atypical laterality than right-handers on the Rhyme Decision, Dichotic listening, or Chimeric Faces tasks?

-	Do the laterality indices from the language and faces laterality tasks correlate? This question will be considered separately for left- and right-handers, since our previous research on language laterality indicated a single factor provided a good fit to data from right-handers but not left-handers.

To answer these questions, we derived four hypotheses. Each are tested below after the reliability assessment.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(tidyverse)
library(MASS)
library(lavaan)
library(qpcR)
library(tidyverse)
library(semPlot)
library(RVAideMemoire)
```

# Reliability 

For the reliability assessment, we will first plot the distributions of laterality indices and check them for normality using the Shapiro-Wilk test. For normally-distributed scores, we will compute Pearson correlation coefficients for time 1 vs time 2, after excluding outliers. If scores are not normally distributed, we will consider transforming data to achieve normality (see ‘Transformations’ below), or alternatively use a Spearman correlation if, for instance, data are bimodally distributed.

First, we read in the LI data which was generated by running the the "battery-preprocessing_v5_DB.Rmd" script.

```{r read_dat}
# read in data from csv
LIs <- read.csv("LIs.csv", na.strings = c("NA", ""))
# then we exclude those who we do not have full datasets for 
LIs <- subset(LIs, exclude== 0)
```

Now we plot the distribution of the correlations.

### Rhyme Detection

**LI**

Here, we assess the LI reliability for the Rhyme detection task (RT). First this is done for raw LI.

```{r RDT LI reliability, include=TRUE}
# first, we consider the LIs for RDT accuracy
# day 1
# plot density
ggplot(LIs, aes(x=Day1.RDT_RT_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("RDT RT LI (day 1)")
# normality
shapiro.test(LIs$Day1.RDT_RT_LI)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2.RDT_RT_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("RDT RT LI (day 2)")
# normality
shapiro.test(LIs$Day2.RDT_RT_LI)
# as neither are of normal distribution, conduct Spearman's
# plot
rhyme_scatter <- ggplot(LIs, aes(x= Day1.RDT_RT_LI, y= Day2.RDT_RT_LI)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) + 
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Rhyme decision LI (day 2)") + 
  xlab("Rhyme decision LI (day 1)") +
  annotate("text", x = 8, y = 8, label = "paste(italic(R), \" = .47\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(rhyme_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1.RDT_RT_LI, LIs$Day2.RDT_RT_LI, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1.RDT_RT_LI, LIs$Day2.RDT_RT_LI, method = "spearman", alternative = "greater")
```

**t-score**

Now consider the t score. 

```{r RDT t reliability, include=TRUE}
# first, we consider the LIs for RDT accuracy
# day 1
# plot density
ggplot(LIs, aes(x=t1))+geom_density(linetype="dashed")+theme_classic()+ggtitle("RDT t-score LI (day 1)")
# normality
shapiro.test(LIs$t1)
# day 2
# plot denisty
ggplot(LIs, aes(x=t2))+geom_density(linetype="dashed")+theme_classic()+ggtitle("RDT t-score LI (day 2)")
# normality
shapiro.test(LIs$t2)
# as neither are of normal distribution, conduct Spearman's
# plot
rhyme_scatter <- ggplot(LIs, aes(x= t1, y= t2)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) + 
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Rhyme decision t-score (day 2)") + 
  xlab("Rhyme decision t-score (day 1)") +
  annotate("text", x = 8, y = 8, label = "paste(italic(R), \" = -.03\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(rhyme_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$t1, LIs$t2, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$t1, LIs$t2, method = "spearman", alternative = "greater")
```

Analysis indicates this is below the satisfactory r= .65, so the utility of this task doesn't seem ideal.

### Dichotic listening

**LI**

```{r DL reliability, include=TRUE}
# day 1
# plot density
ggplot(LIs, aes(x=Day1_DL_acc_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("DL ACC LI (day 1)")
# normality
shapiro.test(LIs$Day1_DL_acc_LI)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2_DL_acc_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("DL ACC LI (day 2)")
# normality
shapiro.test(LIs$Day1_DL_acc_LI)
# as neither are of normal distribution, conduct Spearman's
# plot
DL_scatter <- ggplot(LIs, aes(x= Day1_DL_acc_LI, y= Day2_DL_acc_LI)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Dichotic listening LI (day 2)") + 
  xlab("Dichotic listening LI (day 1)") +
  xlim(-100, 100) + ylim(-100, 100) +
  annotate("text", x = 90, y = 90, label = "paste(italic(R), \" = .78\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(DL_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_DL_acc_LI, LIs$Day2_DL_acc_LI, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_DL_acc_LI, LIs$Day2_DL_acc_LI, method = "spearman", alternative = "greater")
```

**z-score**

```{r DL z reliability, include=TRUE}
# day 1
# plot density
ggplot(LIs, aes(x=Day1_Dich_acc_Z))+geom_density(linetype="dashed")+theme_classic()+ggtitle("DL ACC z-score (day 1)")
# normality
shapiro.test(LIs$Day1_Dich_acc_Z)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2_Dich_acc_Z))+geom_density(linetype="dashed")+theme_classic()+ggtitle("DL ACC z-score (day 2)")
# normality
shapiro.test(LIs$Day2_Dich_acc_Z)
# as neither are of normal distribution, conduct Spearman's
# plot
DL_scatter <- ggplot(LIs, aes(x= Day1_Dich_acc_Z, y= Day2_Dich_acc_Z)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Dichotic listening z-score (day 2)") + 
  xlab("Dichotic listening z-score (day 1)") +
  xlim(-100, 100) + ylim(-100, 100) +
  annotate("text", x = 90, y = 90, label = "paste(italic(R), \" = .78\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(DL_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_Dich_acc_Z, LIs$Day2_Dich_acc_Z, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_Dich_acc_Z, LIs$Day2_Dich_acc_Z, method = "spearman", alternative = "greater")
```

The dichotic listening task comes out pretty good and exceeds our threshold for reliabiliity. 

### Chimeric Faces

**LI**

```{r CF reliability, include=TRUE}
# day 1
# plot density
ggplot(LIs, aes(x=Day1_CF_acc_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("CF ACC LI (day 1)")
# normality
shapiro.test(LIs$Day1_CF_acc_LI)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2_CF_acc_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("CF ACC LI (day 2)")
# normality
shapiro.test(LIs$Day2_CF_acc_LI)
# as neither are of normal distribution, conduct Spearman's
# plot
CF_scatter <- ggplot(LIs, aes(x= Day1_CF_acc_LI, y= Day2_CF_acc_LI)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Chimeric faces LI (day 2)") + 
  xlab("Chimeric faces LI (day 1)") +
  xlim(-100, 100) + ylim(-100, 100) +
  annotate("text", x = 90, y = 90, label = "paste(italic(R), \" = .87\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(CF_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_CF_acc_LI, LIs$Day2_CF_acc_LI, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_CF_acc_LI, LIs$Day2_CF_acc_LI, method = "spearman", alternative = "greater")
```

**z-score**

```{r CF z reliability, include=TRUE}
# day 1
# plot density
ggplot(LIs, aes(x=Day1_CF_acc_Z))+geom_density(linetype="dashed")+theme_classic()+ggtitle("CF ACC z-score (day 1)")
# normality
shapiro.test(LIs$Day1_CF_acc_Z)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2_CF_acc_Z))+geom_density(linetype="dashed")+theme_classic()+ggtitle("CF ACC z-score (day 2)")
# normality
shapiro.test(LIs$Day2_CF_acc_Z)
# as neither are of normal distribution, conduct Spearman's
# plot
CF_scatter <- ggplot(LIs, aes(x= Day1_CF_acc_Z, y= Day2_CF_acc_Z)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Chimeric faces z-score (day 2)") + 
  xlab("Chimeric faces z-score (day 1)") +
  xlim(-100, 100) + ylim(-100, 100) +
  annotate("text", x = 90, y = 90, label = "paste(italic(R), \" = .88\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(CF_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_CF_acc_Z, LIs$Day2_CF_acc_Z, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_CF_acc_Z, LIs$Day2_CF_acc_Z, method = "spearman", alternative = "greater")
```

The chimeric faces task does well and seems very reliable. 

### Finger tapping 

**LI**

```{r FT reliability, include=TRUE}
# day 1
# plot density
ggplot(LIs, aes(x=Day1_finger_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("FT LI (day 1)")
# normality
shapiro.test(LIs$Day1_finger_LI)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2_finger_LI))+geom_density(linetype="dashed")+theme_classic()+ggtitle("FT LI (day 2)")
# normality
shapiro.test(LIs$Day2_finger_LI)
# as neither are of normal distribution, conduct Spearman's
# plot
finger_scatter <- ggplot(LIs, aes(x= Day1_finger_LI, y= Day2_finger_LI)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Finger tapping LI (day 2)") + 
  xlab("Finger tapping LI (day 1)") +
  annotate("text", x = 18, y = 18, label = "paste(italic(R), \" = .78\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(finger_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_finger_LI, LIs$Day2_finger_LI, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_finger_LI, LIs$Day2_finger_LI, method = "spearman", alternative = "greater")
```

**z-score**

```{r FT z reliability, include=TRUE}
# day 1
# plot density
ggplot(LIs, aes(x=Day1_Finger_acc_Z))+geom_density(linetype="dashed")+theme_classic()+ggtitle("FT z-score (day 1)")
# normality
shapiro.test(LIs$Day1_Finger_acc_Z)
# day 2
# plot denisty
ggplot(LIs, aes(x=Day2_Finger_acc_Z))+geom_density(linetype="dashed")+theme_classic()+ggtitle("FT z-score (day 2)")
# normality
shapiro.test(LIs$Day2_Finger_acc_Z)
# as neither are of normal distribution, conduct Spearman's
# plot
finger_scatter <- ggplot(LIs, aes(x= Day1_Finger_acc_Z, y= Day2_Finger_acc_Z)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Finger tapping z-score (day 2)") + 
  xlab("Finger tapping z-score (day 1)") +
  annotate("text", x = 18, y = 18, label = "paste(italic(R), \" = .78\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(finger_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_Finger_acc_Z, LIs$Day2_Finger_acc_Z, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_Finger_acc_Z, LIs$Day2_Finger_acc_Z, method = "spearman", alternative = "greater")
```

The finger tapping tasks yields a reliable correlation, and seems to relate to categorical handedness.

**Finger tapping and EHI**

```{r fingerEHI}
# plot
finger_scatter <- ggplot(LIs, aes(x= index_EHI, y= Day1_finger_LI)) +
  geom_hline(yintercept=0, color = "black") +
  geom_vline(xintercept=0, color = "black") +
  geom_point(aes(color= handedness)) +
  geom_rug(aes(color= handedness)) +
  theme_classic() +
  ylab("Finger tapping LI (day 1)") + 
  xlab("EHI") +
  annotate("text", x = 90, y = 25, label = "paste(italic(R), \" = .58\")", parse = TRUE) +
  theme(legend.position = c(.15, .90))
# Set relative size of marginal plots (main plot 10x bigger than marginals)
ggExtra::ggMarginal(finger_scatter, groupColour = TRUE, groupFill = TRUE)
# spearman's CIs
spearman.ci(LIs$Day1_finger_LI, LIs$index_EHI, nrep = 10000, conf.level = 0.95)
# spearman's test
cor.test(LIs$Day1_finger_LI, LIs$index_EHI, method = "spearman", alternative = "greater")
# LEFT HANDERS
left <- subset(LIs, handedness== "Left")
# spearman's test
cor.test(left$Day1_finger_LI, left$index_EHI, method = "spearman", alternative = "greater")
# Right HANDERS
right <- subset(LIs, handedness== "Right")
# spearman's test
cor.test(right$Day1_finger_LI, right$index_EHI, method = "spearman", alternative = "greater")
```

Upon an initial look, there is a reasonable correlation between the EHI and day 1 on the finger tapping. However, it does look like there are two clusters. So, we take a loo at the left and right handers seperately. Doing so yields dissappointing results.

## Hypothesis 1

At the population level, the laterality indices for Rhyme Decision will show a right visual field advantage (indicating left hemisphere dominance for language processing); the laterality indices for the Dichotic Listening task will show a right ear advantage (indicating left hemisphere dominance for language); the laterality indices for Chimeric Faces will show a left visual field advantage (indicating right hemisphere dominance for face or emotion processing); and the Finger Tapping task will show a right hand advantage.

To assess hypothesis 1, we pre-registered that the predictions would be tested using a one-sample t-test for each task using session 1 data.

All LIs were calculated as: [(R - L)/(R + L)] × 100, resulting in values between -100 and 100

Now we run a one-sampled t-test against zero for each test using day 1 data. We consider the accuracy LI for chimeric faces, dichotic listening, and finger tapping. The RT LI is used for the rhyme task.

```{r H1}
# corrplot the correlation matrix
mycols <- c('Day1_CF_acc_LI', 'Day1_DL_acc_LI', 'Day1.RDT_RT_LI', 'Day1_finger_LI', "handedness")
colnums<- which(colnames(LIs) %in% mycols)
M <- LIs[,colnums]
N <- M %>% 
  rename(
    "CF" = Day1_CF_acc_LI,
    "DL" = Day1_DL_acc_LI,
    "RD" = Day1.RDT_RT_LI,
    "FT" = Day1_finger_LI)
# PLOT TO SEE IF DIFFERENT FROM ZERO
N$ID <- 1:nrow(N)
# format to long
data_long <- tidyr::gather(N, task, index, `CF`:`FT`, factor_key=TRUE)
# plot data
a <- ggplot(subset(data_long, task== "RD"), aes(x = task, y = index)) +
  geom_hline(yintercept=0, linetype="dashed", color = "red") +
  ggpirate::geom_pirate(aes(colour = "black"), bars = FALSE, 
                        points_params = list(shape = 19, alpha = 0.5), lines_params = list(size = 0.8)) +
  ylab("Laterality Index") + xlab("") + ylim(-30, 30) +
  scale_colour_manual(values = "darkgray") + theme_classic() 
b <- ggplot(subset(data_long, task== "DL"), aes(x = task, y = index)) +
  geom_hline(yintercept=0, linetype="dashed", color = "red") +
  ggpirate::geom_pirate(aes(colour = "black"), bars = FALSE, 
                        points_params = list(shape = 19, alpha = 0.5), lines_params = list(size = 0.8)) +
  ylab("Laterality Index") + xlab("") + ylim(-100, 100) +
  scale_colour_manual(values = "darkgray") + theme_classic() 
c <- ggplot(subset(data_long, task== "CF"), aes(x = task, y = index)) +
  geom_hline(yintercept=0, linetype="dashed", color = "red") +
  ggpirate::geom_pirate(aes(colour = "black"), bars = FALSE, 
                        points_params = list(shape = 19, alpha = 0.5), lines_params = list(size = 0.8)) +
  ylab("Laterality Index") + xlab("") + ylim(-100, 100) +
  scale_colour_manual(values = "darkgray") + theme_classic() 
d <- ggplot(subset(data_long, task== "FT"), aes(x = task, y = index)) +
  geom_hline(yintercept=0, linetype="dashed", color = "red") +
  ggpirate::geom_pirate(aes(colour = "black"), bars = FALSE, 
                        points_params = list(shape = 19, alpha = 0.5), lines_params = list(size = 0.8)) +
  ylab("Laterality Index") + xlab("") + ylim(-30, 30) +
  scale_colour_manual(values = "darkgray") + theme_classic() 
ggpubr::ggarrange(a, b, c, d)
t.test(LIs$Day1_CF_acc_LI, mu= 0)
t.test(LIs$Day1_DL_acc_LI, mu= 0)
t.test(LIs$Day1_finger_LI, mu= 0)
t.test(LIs$Day1.RDT_RT_LI, mu= 0)
```

For hypothesis 1,

- rhyme task is different from zero but indicates a LVF advantage.

- dichotic listening is different from zero and shows a right ear advantage.

- chimeric faces is different from zero and shows a left visual field advantage.

- finger tapping is different from zero and shows a right hand advanatge. 

## Hypothesis 2

Strong left-handers (i.e. those with laterality quotient of -90 or less on the Edinburgh Handedness Inventory) will be more likely to show atypical laterality (i.e. laterality in the opposite direction to our population level predictions) than right-handers. This prediction follows from observations by Mazoyer et al (2014) who studied a large group of left- and right-handers using fMRI to measure language laterality. They concluded "concordance of hemispheric dominance for hand and for language occurs barely above the chance level, except in a group of rare individuals (less than 1% in the general population) who exhibit strong right hemisphere dominance for both language and their preferred hand."

The test of this hypothesis will be complicated by having to decide how to define 'atypical'. Ideally, these would be individuals who have significant lateralisation in the opposite direction to the majority, as indicated by p < .05 on the individual z-score or t-score. We anticipate, however, that this criterion may select very few cases on some of our tasks, in which case we will adjust the cutoff on that task until we have at least 20 atypical cases. Once typicality is defined, we will first analyse atypicality on the Rhyme Decision and Chimeric Faces task. Participants will be categorised into four groups: typical on both; atypical on Rhyme Decision only; atypical on Chimeric Faces only, and atypical on both. A chi square test will be used to test for association with the number of people in each of the four groups and the handedness classification from the Edinburgh Handedness Inventory. This will then be repeated for the Dichotic Listening and the Chimeric Faces tasks. 

As our rhyme task was not relibale, we drop this task here and focus only on the dichotic and faces.

```{r H2, include=TRUE}
# create new variable for atypicality 
LIs <- 
  LIs %>% 
  mutate(atypicality= ifelse(Day1_CF_acc_Z > 1.96 & Day1_Dich_acc_Z < -1.96, "typical",
                          ifelse(Day1_CF_acc_Z > 1.96 & Day1_Dich_acc_Z > 1.96, "atypical dichotic",
                                 ifelse(Day1_CF_acc_Z < -1.96 & Day1_Dich_acc_Z < -1.96, "atypical face",
                                        ifelse(Day1_CF_acc_Z < -1.96 & Day1_Dich_acc_Z > 1.96, "atypical both", NA)))))
# create handedness for handedness on EHI 
LIs <- 
  LIs %>% 
  mutate(hand_90= ifelse(index_EHI >= 90, "right handed",
                         ifelse(index_EHI <= -9, "left handed", NA)))
# create a table for chi-squared
tbl <- table(LIs$atypicality, LIs$hand_90)
tbl
# run chi squared
chisq.test(tbl)
# use balloon plot to visualise
gplots::balloonplot(t(tbl), main ="Association of EHI handeness and atypical laterality", xlab ="", ylab="",
            label = FALSE, show.margins = FALSE)
```

Using a t score of 1.96 as our cutoff (equaiting to .05 on a two-tailed test) results in more than the 20 atypicals we wanted. Left handers do appear to depart from typcality more. 

## Hypothesis 3

For right-handers, a model 

(a) where the two language tasks are correlated with each other but not with the chimeric faces will provide better fit to the data than a model 

(b) in which laterality indices are correlated between the language and chimeric face tasks, or a base model 

(c) where each task is independently lateralised. 

For left-handers, we anticipate that that model (c) may be a better fit to the data, indicating that laterality is dissociated across the different tasks. 

Using a structural equation modelling framework, we will compare the covariances of the laterality statistics between the two language tasks and chimeric faces to test between three models. This will be done separately for left- and right-handers. Before doing this we will flip the polarity of chimeric faces, so that all predictions are for positive correlations.

- Model 1: the only significant correlations will be within-task. I.e. each task will be reliable in the sense that it correlates with itself, but it will not correlate with other tasks.

- Model 2: there will be significant within-task correlations, and significant between-task correlations for the language tasks only. The chimeric faces will not be correlated with either language task.

- Model 3: There are significant correlations between all tasks, indicating a single laterality factor affecting performance.

We anticipate that model 2 may fit right-handers, whereas model 1 seems more likely for left-handers.

```{r prep_dat}
# now create subset of data frame for analysis
mycols <- c('Day1_CF_acc_LI', 'Day2_CF_acc_LI',
            'Day1_DL_acc_LI', 'Day2_DL_acc_LI',
            'Day1.RDT_RT_LI', 'Day2.RDT_RT_LI',
            'handedness')
colnums<- which(colnames(LIs) %in% mycols)
M <- LIs[,colnums]
M <- M %>% 
  rename(
    "faces1" = Day1_CF_acc_LI,
    "faces2" = Day2_CF_acc_LI,
    "dichotic1" = Day1_DL_acc_LI,
    "dichotic2" = Day2_DL_acc_LI,
    "rhyme1" = Day1.RDT_RT_LI,
    "rhyme2" = Day2.RDT_RT_LI)
# subset into right and left handers
left_dat <- subset(M, handedness== "Left")
right_dat <- subset(M, handedness== "Right")
```

### Left handers:

Here we model left hander data with three prespecified covariance structures, then compare using AIC weights.

This is a subset of SEM that dos not include any latent variables or directional paths. It only looks to constrain particular covariance patterns and report 'best' model according AIC weights.

```{r Roger_mod_left}
model1<-"
dichotic1~~0*rhyme1
dichotic1~~0*faces1 
rhyme1~~0*faces1 
"

model2<-"
dichotic1~~rhyme1 
dichotic1~~0*faces1
rhyme1~~0*faces1 
"

model3<-"
dichotic1~~rhyme1 
dichotic1~~faces1 
rhyme1~~faces1
"

fit1A <- cfa(model1, data=left_dat)
fit2A <- cfa(model2, data=left_dat)
fit3A <- cfa(model3, data=left_dat)

aic_vector1 <- c(fitMeasures(fit1A, "aic"),fitMeasures(fit2A, "aic"),fitMeasures(fit3A, "aic"))

summary(fit1A, fit.measures=TRUE)
summary(fit2A, fit.measures=TRUE)
summary(fit3A, fit.measures=TRUE)

AICweights1<-akaike.weights(aic_vector1)$weights

IC_objectweights1<-data.frame(Model=factor(rep(c('Model 1','Model 2','Model 3'))), IC = factor(rep('AIC',each=3)),values=AICweights1)

ggplot(IC_objectweights1,aes(Model,values,fill=Model))+
  geom_bar(stat='identity',position="dodge")+
  ylab('Akaike weights') + theme_classic()
```

We now repeat this for right handers. 

```{r Roger_mod_right}
fit1B <- cfa(model1, data=right_dat)
fit2B <- cfa(model2, data=right_dat)
fit3B <- cfa(model3, data=right_dat)

aic_vector2 <- c(fitMeasures(fit1B, "aic"),fitMeasures(fit2B, "aic"),fitMeasures(fit3B, "aic"))

summary(fit1B, fit.measures=TRUE)
summary(fit2B, fit.measures=TRUE)
summary(fit3B, fit.measures=TRUE)

AICweights2<-akaike.weights(aic_vector2)$weights

IC_objectweights2<-data.frame(Model=factor(rep(c('Model 1','Model 2','Model 3'))), IC = factor(rep('AIC',each=3)),values=AICweights2)

ggplot(IC_objectweights2,aes(Model,values,fill=Model)) +
  geom_bar(stat='identity',position="dodge")+
  ylab('Akaike weights') + theme_classic()
```